# Tagging MCP Server - Environment Configuration

# Server Configuration
MCP_SERVER_HOST=0.0.0.0
MCP_SERVER_PORT=8080
LOG_LEVEL=INFO
ENVIRONMENT=development
DEBUG=false

# Redis Configuration
REDIS_URL=redis://redis:6379/0
REDIS_PASSWORD=
REDIS_TTL=3600

# AWS Configuration
AWS_REGION=us-east-1
AWS_DEFAULT_REGION=us-east-1

# Policy Configuration
POLICY_FILE_PATH=/app/policies/tagging-policy.json

# Database Configuration
# Path to the audit logs SQLite database
AUDIT_DB_PATH=/app/data/audit_logs.db

# Path to the compliance history SQLite database  
HISTORY_DB_PATH=/app/data/compliance_history.db

# ============================================================================
# SECURITY CONFIGURATION (Requirements: 16.1, 16.2, 16.5)
# ============================================================================

# Request Sanitization (Requirements: 16.2, 16.5)
# Enable/disable request sanitization middleware
REQUEST_SANITIZATION_ENABLED=true

# Maximum request body size in bytes (default: 10 MB)
MAX_REQUEST_SIZE_BYTES=10485760

# Maximum total header size in bytes (default: 8 KB)
MAX_HEADER_SIZE_BYTES=8192

# Maximum number of headers allowed (default: 50)
MAX_HEADER_COUNT=50

# Maximum query string length in characters (default: 4096)
MAX_QUERY_STRING_LENGTH=4096

# Maximum URL path length in characters (default: 2048)
MAX_PATH_LENGTH=2048

# Timeout Configuration (Requirements: 16.1, 16.2)
# Maximum time allowed for a single tool execution in seconds (default: 30)
TOOL_EXECUTION_TIMEOUT_SECONDS=30

# Timeout for AWS API calls in seconds (default: 10)
AWS_API_TIMEOUT_SECONDS=10

# Timeout for Redis operations in seconds (default: 5)
REDIS_TIMEOUT_SECONDS=5

# Timeout for HTTP requests in seconds (default: 30)
HTTP_REQUEST_TIMEOUT_SECONDS=30

# Rate Limiting Configuration (Requirements: 16.2)
# Enable/disable rate limiting for API requests
RATE_LIMIT_ENABLED=true

# Maximum requests allowed per minute per IP (default: 60)
RATE_LIMIT_REQUESTS_PER_MINUTE=60

# Burst size for rate limiting (default: 10)
RATE_LIMIT_BURST_SIZE=10

# ============================================================================
# AGENT OBSERVABILITY AND GUARDRAILS (Requirements: 15.1, 15.3, 15.4)
# ============================================================================

# Tool-Call Budget Enforcement (Requirements: 15.3)
# Enable/disable tool-call budget tracking per session
BUDGET_TRACKING_ENABLED=true

# Maximum tool calls allowed per session (default: 100)
MAX_TOOL_CALLS_PER_SESSION=100

# TTL for session budget tracking in seconds (default: 3600 = 1 hour)
SESSION_BUDGET_TTL_SECONDS=3600

# Loop Detection (Requirements: 15.4)
# Enable/disable loop detection for repeated identical tool calls
LOOP_DETECTION_ENABLED=true

# Maximum identical calls allowed before blocking (default: 3)
MAX_IDENTICAL_CALLS=3

# Time window for tracking identical calls in seconds (default: 300 = 5 minutes)
LOOP_DETECTION_WINDOW_SECONDS=300

# Security Monitoring (Requirements: 16.4)
# Enable/disable security event monitoring and rate limiting
SECURITY_MONITORING_ENABLED=true

# Maximum unknown tool attempts allowed per session before rate limiting (default: 5)
MAX_UNKNOWN_TOOL_ATTEMPTS=5

# Time window for tracking security events in seconds (default: 300 = 5 minutes)
SECURITY_EVENT_WINDOW_SECONDS=300

# ============================================================================
# CLOUDWATCH LOGGING (Requirements: 13.3)
# ============================================================================

# Enable/disable CloudWatch logging
CLOUDWATCH_ENABLED=false

# CloudWatch log group name
CLOUDWATCH_LOG_GROUP=/tagging-mcp-server

# CloudWatch log stream name (auto-generated if not set)
CLOUDWATCH_LOG_STREAM=

# CloudWatch log stream name for security events
SECURITY_LOG_STREAM=security
